{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _taggedTemplateLiteralLoose from\"@babel/runtime/helpers/taggedTemplateLiteralLoose\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5;import _regeneratorRuntime from\"@babel/runtime/regenerator\";import\"react-native-gesture-handler\";import React,{useContext,useEffect,useState}from\"react\";import Image from\"react-native-web/dist/exports/Image\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import ImageBackground from\"react-native-web/dist/exports/ImageBackground\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import View from\"react-native-web/dist/exports/View\";import SafeAreaView from\"react-native-web/dist/exports/SafeAreaView\";import{Comfortaa_700Bold,Comfortaa_400Regular,useFonts}from\"@expo-google-fonts/comfortaa\";import{OpenSans_400Regular}from\"@expo-google-fonts/open-sans\";import DashboardHeader from\"./components/DashboardHeader\";import CustomInput from\"./components/generics/CustomInput\";import CustomTouchableOpacity from\"./components/generics/CustomTouchableOpacity\";import styled from\"styled-components/native\";import RulewebContext from\"./RulewebContext\";import PrizeStat from\"./components/generics/PrizeStat\";import APIHandler from\"./APIHandler\";import{EmailIsValid,isComplete}from\"./Validations\";var Wrapper=styled.View(_templateObject||(_templateObject=_taggedTemplateLiteralLoose([\"\\n  background: white;\\n  display: flex;\\n  flex-direction: column;\\n  height: 100%;\\n\"])));var ContentWrapper=styled.View(_templateObject2||(_templateObject2=_taggedTemplateLiteralLoose([\"\\n  background: white;\\n  display: flex;\\n  flex-direction: column;\\n  flex-grow: 1;\\n  padding: 20px 16px 24px;\\n  max-width: 600px;\\n  align-self: center;\\n\"])));var Centered=styled.View(_templateObject3||(_templateObject3=_taggedTemplateLiteralLoose([\"\\n  background: white;\\n  display: flex;\\n  flex-direction: column;\\n  flex-wrap: nowrap;\\n  align-content: stretch;\\n  align-items: stretch;\\n\"])));var Title=styled.Text(_templateObject4||(_templateObject4=_taggedTemplateLiteralLoose([\"\\n  font-size: 18px;\\n  line-height: 24px;\\n  text-align: left;\\n  letter-spacing: 0.15px;\\n  color: #002350;\\n\"])));var Paragraph=styled.Text(_templateObject5||(_templateObject5=_taggedTemplateLiteralLoose([\"\\n  font-size: 14px;\\n  line-height: 24px;\\n  text-align: left;\\n  letter-spacing: 0.15px;\\n  color: #353535;\\n\"])));export default function Dashboard(_ref){var navigation=_ref.navigation;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),userEmail=_useState2[0],setUserEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),prizeToken=_useState4[0],setPrizeToken=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),shopRewards=_useState6[0],setShopRewards=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),userEmailInp=_useState8[0],setUserEmailInp=_useState8[1];var _useContext=useContext(RulewebContext),isAuthorized=_useContext.isAuthorized,setIsAuthorized=_useContext.setIsAuthorized,shopData=_useContext.shopData,email=_useContext.email;useFonts({Comfortaa_700Bold:Comfortaa_700Bold,Comfortaa_400Regular:Comfortaa_400Regular,OpenSans_400Regular:OpenSans_400Regular});useEffect(function(){getRewards();},[]);function getRewards(){var res;return _regeneratorRuntime.async(function getRewards$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(APIHandler.post(\"/rewards/byShop\",{email:email}));case 2:res=_context.sent;setShopRewards(res.data);case 4:case\"end\":return _context.stop();}}},null,null,null,Promise);}var handleUserEmail=function handleUserEmail(inp){EmailIsValid(inp)&&setUserEmail(inp);setUserEmailInp(inp);};function clearInputs(){setUserEmailInp(\"\");setPrizeToken(\"\");}var handleSubmit=function handleSubmit(e){APIHandler.post(\"/rewards/redeem\",{token:prizeToken,email:userEmail,shop:shopData.email}).then(function(res){if(res.status===200){clearInputs();navigation.navigate(\"Result\",{statusCode:res.data.status,prize:{title:res.data.prize.title,redemptionDate:res.data.updatedAt,playerEmail:res.data.player.email,token:res.data.token}});}}).catch(function(err){navigation.navigate(\"Error\",{error:err.response.data.message});});};return React.createElement(SafeAreaView,null,React.createElement(Wrapper,null,React.createElement(DashboardHeader,{onPress:function onPress(){return setIsAuthorized(false);},shopData:shopData}),React.createElement(ContentWrapper,null,React.createElement(Centered,{style:{flexGrow:0,rowGap:12}},React.createElement(Title,{style:{fontFamily:\"Comfortaa_700Bold\"}},\"Ingres\\xE1 el mail y el c\\xF3digo de canje.\"),React.createElement(Paragraph,{style:{fontFamily:\"OpenSans_400Regular\"}},\"Este se envi\\xF3 por mail al cliente al momento de ganar el premio.\")),React.createElement(Centered,{style:{flexGrow:0,rowGap:15,marginTop:34,marginBottom:40}},React.createElement(CustomInput,{placeholder:\"Email\",value:userEmailInp,onChangeText:function onChangeText(txt){return handleUserEmail(txt);}}),React.createElement(CustomInput,{placeholder:\"Codigo de canje\",value:prizeToken,onChangeText:function onChangeText(txt){return setPrizeToken(txt);}})),React.createElement(CustomTouchableOpacity,{title:\"Canjear\",behavior:handleSubmit,disabled:!isComplete(userEmail,prizeToken)})),React.createElement(PrizeStat,{name:\"Total premios entregados\",number:shopRewards.redeemed}),React.createElement(PrizeStat,{name:\"Listos para canjear\",number:shopRewards.available})));}","map":{"version":3,"sources":["/Users/augustotoloza/Documents/School/ruletap-mobile/ruleweb-rn/Dashboard.js"],"names":["React","useContext","useEffect","useState","Comfortaa_700Bold","Comfortaa_400Regular","useFonts","OpenSans_400Regular","DashboardHeader","CustomInput","CustomTouchableOpacity","styled","RulewebContext","PrizeStat","APIHandler","EmailIsValid","isComplete","Wrapper","View","ContentWrapper","Centered","Title","Text","Paragraph","Dashboard","navigation","userEmail","setUserEmail","prizeToken","setPrizeToken","shopRewards","setShopRewards","userEmailInp","setUserEmailInp","isAuthorized","setIsAuthorized","shopData","email","getRewards","post","res","data","handleUserEmail","inp","clearInputs","handleSubmit","e","token","shop","then","status","navigate","statusCode","prize","title","redemptionDate","updatedAt","playerEmail","player","catch","err","error","response","message","flexGrow","rowGap","fontFamily","marginTop","marginBottom","txt","redeemed","available"],"mappings":"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","sourcesContent":["import \"react-native-gesture-handler\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport {\n  Image,\n  TouchableOpacity,\n  ImageBackground,\n  StyleSheet,\n  View,\n  SafeAreaView,\n} from \"react-native\";\nimport {\n  Comfortaa_700Bold,\n  Comfortaa_400Regular,\n  useFonts,\n} from \"@expo-google-fonts/comfortaa\";\nimport { OpenSans_400Regular } from \"@expo-google-fonts/open-sans\";\nimport DashboardHeader from \"./components/DashboardHeader\";\nimport CustomInput from \"./components/generics/CustomInput\";\nimport CustomTouchableOpacity from \"./components/generics/CustomTouchableOpacity\";\nimport styled from \"styled-components/native\";\nimport RulewebContext from \"./RulewebContext\";\nimport PrizeStat from \"./components/generics/PrizeStat\";\nimport APIHandler from \"./APIHandler\";\nimport { EmailIsValid, isComplete } from \"./Validations\";\n\nconst Wrapper = styled.View`\n  background: white;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n`;\nconst ContentWrapper = styled.View`\n  background: white;\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  padding: 20px 16px 24px;\n  max-width: 600px;\n  align-self: center;\n`;\nconst Centered = styled.View`\n  background: white;\n  display: flex;\n  flex-direction: column;\n  flex-wrap: nowrap;\n  align-content: stretch;\n  align-items: stretch;\n`;\nconst Title = styled.Text`\n  font-size: 18px;\n  line-height: 24px;\n  text-align: left;\n  letter-spacing: 0.15px;\n  color: #002350;\n`;\nconst Paragraph = styled.Text`\n  font-size: 14px;\n  line-height: 24px;\n  text-align: left;\n  letter-spacing: 0.15px;\n  color: #353535;\n`;\n\nexport default function Dashboard({ navigation }) {\n  const [userEmail, setUserEmail] = useState(\"\");\n  const [prizeToken, setPrizeToken] = useState(\"\");\n  const [shopRewards, setShopRewards] = useState(\"\");\n  const [userEmailInp, setUserEmailInp] = useState(\"\");\n  const { isAuthorized, setIsAuthorized, shopData, email } =\n    useContext(RulewebContext);\n  useFonts({\n    Comfortaa_700Bold,\n    Comfortaa_400Regular,\n    OpenSans_400Regular,\n  });\n  useEffect(() => {\n    getRewards();\n  }, []);\n  async function getRewards() {\n    const res = await APIHandler.post(\"/rewards/byShop\", { email });\n    setShopRewards(res.data);\n  }\n  const handleUserEmail = (inp) => {\n    EmailIsValid(inp) && setUserEmail(inp);\n    setUserEmailInp(inp);\n  };\n  function clearInputs() {\n    setUserEmailInp(\"\");\n    setPrizeToken(\"\");\n  }\n  const handleSubmit = (e) => {\n    APIHandler.post(\"/rewards/redeem\", {\n      token: prizeToken,\n      email: userEmail,\n      shop: shopData.email,\n    })\n      .then((res) => {\n        if (res.status === 200) {\n          clearInputs();\n          navigation.navigate(\"Result\", {\n            statusCode: res.data.status,\n            prize: {\n              title: res.data.prize.title,\n              redemptionDate: res.data.updatedAt,\n              playerEmail: res.data.player.email,\n              token: res.data.token,\n            },\n          });\n        }\n      })\n      .catch((err) => {\n        navigation.navigate(\"Error\", {\n          error: err.response.data.message,\n        });\n      });\n  };\n\n  return (\n    <SafeAreaView>\n      <Wrapper>\n        <DashboardHeader\n          onPress={() => setIsAuthorized(false)}\n          shopData={shopData}\n        />\n        <ContentWrapper>\n          <Centered style={{ flexGrow: 0, rowGap: 12 }}>\n            <Title style={{ fontFamily: \"Comfortaa_700Bold\" }}>\n              Ingresá el mail y el código de canje.\n            </Title>\n            <Paragraph style={{ fontFamily: \"OpenSans_400Regular\" }}>\n              Este se envió por mail al cliente al momento de ganar el premio.\n            </Paragraph>\n          </Centered>\n          <Centered\n            style={{\n              flexGrow: 0,\n              rowGap: 15,\n              marginTop: 34,\n              marginBottom: 40,\n            }}\n          >\n            <CustomInput\n              placeholder=\"Email\"\n              value={userEmailInp}\n              onChangeText={(txt) => handleUserEmail(txt)}\n            />\n            <CustomInput\n              placeholder=\"Codigo de canje\"\n              value={prizeToken}\n              onChangeText={(txt) => setPrizeToken(txt)}\n            />\n          </Centered>\n\n          <CustomTouchableOpacity\n            title=\"Canjear\"\n            behavior={handleSubmit}\n            disabled={!isComplete(userEmail, prizeToken)}\n          />\n        </ContentWrapper>\n        <PrizeStat\n          name=\"Total premios entregados\"\n          number={shopRewards.redeemed}\n        />\n        <PrizeStat name=\"Listos para canjear\" number={shopRewards.available} />\n      </Wrapper>\n    </SafeAreaView>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}